---
const {
    image,
    alt,
    title,
    subtitle,
    year,
    location,
    role,
    description,
    index = 0
} = Astro.props;

const delay = `${0.12 * index}s`;
---

<div
        class="tile project-tile"
        style={`--delay: ${delay};`}
        data-project-title={title}
        data-project-subtitle={subtitle}
        data-project-year={year}
        data-project-location={location}
        data-project-role={role}
        data-project-description={description}
        data-project-image={image}
>
    <img src={image} alt={alt ?? title} loading="lazy" />
    <div class="overlay">
        <div class="overlay-inner">
            {year && <span class="overlay-kicker">{year}</span>}
            <h2>{title}</h2>
            {subtitle && <p class="overlay-subtitle">{subtitle}</p>}
        </div>
    </div>
</div>

<style>
    .project-tile {
        position: relative;
        width: 100%;
        height: 100%;
        overflow: hidden;
        cursor: pointer;
        background: var(--colour-bg-muted);
    }

    .project-tile img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transform: scale(1.02);
        transition: transform var(--transition-med, 0.3s ease);
        display: block;
    }

    .overlay {
        position: absolute;
        inset: 0;
        background: linear-gradient(
                to top,
                rgba(0, 0, 0, 0.55),
                rgba(0, 0, 0, 0.1),
                rgba(0, 0, 0, 0)
        );
        color: #fff;
        display: flex;
        align-items: flex-end;
        padding: var(--spacing-m, 1.5rem);
        opacity: 0;
        transition: opacity var(--transition-med, 0.3s ease);
    }

    .overlay-inner {
        max-width: 80%;
    }

    .overlay-kicker {
        font-family: Montserrat, monospace;
        font-size: var(--font-size-xs);
        letter-spacing: 0.14em;
        text-transform: uppercase;
        opacity: 0.7;
    }

    h2 {
        margin: 0.2rem 0 0.1rem;
        font-size: var(--font-size-lg);
    }

    .overlay-subtitle {
        margin: 0;
        font-size: var(--font-size-sm);
        opacity: 0.9;
    }

    .project-tile:hover img {
        transform: scale(1.08);
    }

    .project-tile:hover .overlay {
        opacity: 1;
    }

    @media (max-width: 768px) {
        .project-tile {
            flex: 0 0 100%;
            scroll-snap-align: start;
        }

        .overlay {
            opacity: 1;
            background: linear-gradient(
                    to top,
                    rgba(0, 0, 0, 0.55),
                    rgba(0, 0, 0, 0.1),
                    rgba(0, 0, 0, 0)
            );
        }

        .project-tile:hover img {
            transform: scale(1.02);
        }
    }
</style>
